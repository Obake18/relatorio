<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="estilos.css">
    <script type="text/javascript" src="dist/excellentexport.js"></script>
    
    <script type="module" src="logica.js"></script>
    <meta charset="UTF-8">
    <title>Informações do Publicador</title>
</head>

<body>
    <h1>Informações do Publicador</h1>
    <table id="tabelaRelatorios">
        <thead>
            <tr>
                <th>Nome do Publicador</th>
                <th>Mês</th>
                <th>Participou?</th>
                <th>Estudo Bíblico</th>
                <th>Horas</th>
                <th>Minutos</th>
                <th>Observações</th>
            </tr>
        </thead>
        <tbody id="corpoTabela">
            <!-- As linhas de dados serão inseridas aqui -->
        </tbody>
    </table>

    <button id="botaoBaixar">Baixar como CSV</button>

</body>

<script>
function baixarComoCSV() {
    var tabela = document.getElementById('tabelaRelatorios');
    var csv = '';

    // Adicionar cabeçalho e dados
    for (var i = 0; i < tabela.rows.length; i++) {
        var row = Array.from(tabela.rows[i].cells);
        csv += row.map(cell => cell.innerText).join(',') + '\n';
    }

    // Remover a última linha vazia
    csv = csv.slice(0, -1);

    // Codificar os dados da tabela em um formato compatível com URL
    var csvData = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);

    // Criar um link para baixar os dados
    var link = document.createElement('a');
    link.href = csvData;
    link.download = 'dados.csv';
    link.click();
}

// Altere o evento onclick do botão para chamar a função
document.getElementById('botaoBaixar').onclick = baixarComoCSV;

</script>

</html>
