<!DOCTYPE html>
<html lang="pt-br">

<head>
    <script type="module">
        import { getAuth, getRedirectResult } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-auth.js";
    
        const auth = getAuth();
    
        getRedirectResult(auth)
            .then((result) => {
                // Se o resultado for vazio, redirecione para a página de login
                if (!result.user) {
                    window.location.href = "login.html";
                }
                // Se o resultado tiver um usuário, carregue a página normalmente
            })
            .catch((error) => {
                // Trate os possíveis erros de autenticação
                console.error(error);
            });
    </script>
    
    <link rel="stylesheet" href="estilos.css">
    <link rel="icon" href="assets/icon/icone.png?">
    <script type="module" src="logica.js"></script>
    <meta charset="UTF-8">
    <title>Informações do Publicador</title>
</head>

<body class="light-mode">
    <h1>Informações do Publicador</h1>
    <table id="tabelaRelatorios">
        <thead>
            <tr>
                <th>Nome do Publicador</th>
                <th>Mês</th>
                <th>Participou?</th>
                <th>Estudo Bíblico</th>
                <th>Horas</th>
                <th>Minutos</th>
                <th>Observações</th>
            </tr>
        </thead>
        <tbody id="corpoTabela">
            <!-- As linhas de dados serão inseridas aqui -->
        </tbody>
    </table>

    <button id="botaoBaixar">Baixar como CSV</button>
    <button id="mode-toggle">Alternar Modo</button>

</body>

<script>
    var toggleButton = document.getElementById('mode-toggle');
    toggleButton.addEventListener('click', function () {
        if (document.body.classList.contains('light-mode')) {
            document.body.classList.remove('light-mode');
            document.body.classList.add('dark-mode');
        } else {
            document.body.classList.remove('dark-mode');
            document.body.classList.add('light-mode');
        }
    });
</script>
<script>
    function baixarComoCSV() {
        var tabela = document.getElementById('tabelaRelatorios');
        var csv = '';

        // Adicionar cabeçalho e dados
        for (var i = 0; i < tabela.rows.length; i++) {
            var row = Array.from(tabela.rows[i].cells);
            csv += row.map(cell => cell.innerText).join(',') + '\n';
        }

        // Remover a última linha vazia
        csv = csv.slice(0, -1);

        // Codificar os dados da tabela em um formato compatível com URL
        var csvData = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);

        // Criar um link para baixar os dados
        var link = document.createElement('a');
        link.href = csvData;
        link.download = 'dados.csv';
        link.click();
    }

    // Altere o evento onclick do botão para chamar a função
    document.getElementById('botaoBaixar').onclick = baixarComoCSV;

</script>

</html>